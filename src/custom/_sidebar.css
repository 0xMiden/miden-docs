/* ==========================================
   4) SIDEBAR (Docs)
   ========================================== */

/* ThemeClassNames.docs.docSidebarContainer */
.theme-doc-sidebar-container {
  border-right: 1px solid var(--ifm-border-color) !important;
  padding: 5px;
  font-size: 0.875rem; /* Sidebar-specific font size */
}

/* Main docs content area - wider to fill space */
.theme-doc-markdown {
  max-width: 100%; /* Use full available width */
}

/* ThemeClassNames.docs.docSidebarMenu */
.theme-doc-sidebar-menu .menu__link {
  font-family: var(--font-sans);
  letter-spacing: -2%;
  border-radius: var(--radius-md);
  padding: var(--ifm-menu-link-padding-vertical)
    var(--ifm-menu-link-padding-horizontal);
}

/* Base active link styling - color only, backgrounds handled by depth-specific rules */
.theme-doc-sidebar-menu .menu__link--active {
  color: var(--ifm-color-primary);
}

/* Category collapsible */
.menu__list-item-collapsible {
  border-radius: var(--radius-md);
}

/* ==========================================
   4.1) SIDEBAR NESTED HIERARCHY GUIDE LINES
   ========================================== */

/* Indentation for nested lists - keep margin/padding for structure */
.theme-doc-sidebar-item-category-level-1 > ul.menu__list {
  margin-left: 10px;
  padding-left: 14px;
}

.theme-doc-sidebar-item-category-level-2 > ul.menu__list {
  margin-left: 8px;
  padding-left: 12px;
}

/* ==============================================
   ROW-INDICATOR VERTICAL LINES
   Each row owns a line with fixed height = row height.
   Lines do NOT connect rows - they indicate depth.
   Visual continuity comes from alignment, not geometry.
   No sibling logic. Each row is independent.
   ============================================== */

/* All nested menu links get position relative for ::before */
.theme-doc-sidebar-item-category-level-1 ul.menu__list .menu__link {
  position: relative;
}

/* Row-aligned vertical indicator - slight overdraw for visual continuity */
.theme-doc-sidebar-item-category-level-1 ul.menu__list .menu__link::before {
  content: "";
  position: absolute;
  left: -14px;
  top: 50%;
  transform: translateY(-50%);
  height: calc(100% + 4px); /* Overdraw so adjacent rows visually merge */
  width: 1px;
  background: var(--ifm-border-color);
  pointer-events: none;
}

/* Active leaf item line = brand color */
.theme-doc-sidebar-item-category-level-1 ul.menu__list .menu__link--active::before {
  background: var(--ifm-color-primary);
}

/* Category links (with sublist) - muted line */
.theme-doc-sidebar-item-category-level-1 ul.menu__list .menu__link--sublist::before {
  background: var(--ifm-border-color);
}

/* Deeper nesting (L2) - lighter guide line, adjusted position */
.theme-doc-sidebar-item-category-level-2 ul.menu__list .menu__link::before {
  left: -12px;
  background: color-mix(in oklab, var(--ifm-border-color) 60%, transparent);
}

.theme-doc-sidebar-item-category-level-2 ul.menu__list .menu__link--active::before {
  background: color-mix(in oklab, var(--ifm-color-primary) 70%, transparent);
}

/* ==========================================
   4.2) SIDEBAR BOX MODEL & CHEVRON ANIMATION
   ========================================== */

/* Make ALL sidebar menu elements respect container padding (prevents background overflow) */
aside[class*="docSidebarContainer"] .menu,
aside[class*="docSidebarContainer"] .menu__list,
aside[class*="docSidebarContainer"] .menu__list-item,
aside[class*="docSidebarContainer"] .menu__list-item-collapsible,
aside[class*="docSidebarContainer"] .menu__link,
aside[class*="docSidebarContainer"] .menu__caret {
  box-sizing: border-box;
  max-width: 95%;
}

/* Smooth chevron rotation for categories */
/* Also make arrow smaller and thinner (Infima default is 2rem - too large) */
.menu__link--sublist-caret::after,
.menu__caret::before {
  transition: transform 0.2s ease;
  background-size: 1.25rem 1.25rem;
  opacity: 0.6;
}

/* ==============================================
   NORMALIZE CATEGORY ROW LAYOUT
   Fix inconsistent rendering between categories
   with index pages (a.menu__link) vs without (span.menu__link)
   ============================================== */

/* Force unified flex layout for all collapsible categories */
.menu__list-item-collapsible {
  display: flex;
  align-items: center;
}

/* Normalize caret positioning across all categories */
.menu__list-item-collapsible > .menu__caret {
  margin-left: auto;
  align-self: center;
  transform: translateY(0); /* kill inherited offsets */
}

/* Ensure non-link category labels align like links */
.menu__list-item-collapsible > .menu__link {
  display: flex;
  align-items: center;
}

/* ==========================================
   4.3) TOP-LEVEL SECTION STYLING
   ========================================== */

/* Top-level categories get more visual weight */
.theme-doc-sidebar-item-category-level-1 > .menu__list-item-collapsible > .menu__link {
  font-weight: 600;
}

/* Spacing between top-level items */
.theme-doc-sidebar-item-category-level-1 {
  margin-top: 0.5rem;
}

/* First top-level item has no top margin */
.theme-doc-sidebar-item-category-level-1:first-child {
  margin-top: 0;
}

/* --- Background highlight scoping (prevent stacking) --- */

/* Only highlight top-level category when IT is the active link (not descendants) */
.theme-doc-sidebar-item-category-level-1 > .menu__list-item-collapsible > .menu__link--active {
  background: color-mix(in oklab, var(--ifm-color-primary) 8%, transparent);
  border-radius: var(--radius-md);
}

/* Active LEAF items get subtle surface background */
.theme-doc-sidebar-item-link-level-2 > .menu__link--active,
.theme-doc-sidebar-item-link-level-3 > .menu__link--active {
  background: var(--ifm-background-surface-color);
}

/* Child CATEGORIES should NOT get background when expanded */
.theme-doc-sidebar-item-category-level-2 > .menu__list-item-collapsible,
.theme-doc-sidebar-item-category-level-3 > .menu__list-item-collapsible {
  background: transparent !important;
}

/* --- Depth-based text emphasis --- */

/* L1: Brand color, semibold */
.theme-doc-sidebar-item-category-level-1 > .menu__list-item-collapsible > .menu__link--active {
  color: var(--ifm-color-primary);
  font-weight: 600;
}

/* L2 category: Brand color, medium weight */
.theme-doc-sidebar-item-category-level-2 > .menu__list-item-collapsible > .menu__link--active {
  color: var(--ifm-color-primary);
  font-weight: 500;
}

/* L3 active leaf: Strongest brand emphasis */
.theme-doc-sidebar-item-link-level-2 > .menu__link--active,
.theme-doc-sidebar-item-link-level-3 > .menu__link--active {
  color: var(--ifm-color-primary);
  font-weight: 600;
}

/* Inactive items: Neutral text */
.theme-doc-sidebar-item-link-level-2 > .menu__link:not(.menu__link--active),
.theme-doc-sidebar-item-link-level-3 > .menu__link:not(.menu__link--active) {
  color: var(--ifm-color-content);
  font-weight: 400;
}

/* --- Nested items base styling --- */

/* L2 category links (like "Set Up", "Rust Client") - consistent weight */
.theme-doc-sidebar-item-category-level-2 > .menu__list-item-collapsible > .menu__link {
  font-weight: 500;
}

/* L2/L3 leaf items and nested content - smaller font */
.theme-doc-sidebar-item-link-level-2 .menu__link,
.theme-doc-sidebar-item-link-level-3 .menu__link,
.theme-doc-sidebar-item-category-level-2 ul .menu__link,
.theme-doc-sidebar-item-category-level-3 ul .menu__link {
  font-size: 0.85rem;
}

/* ==========================================
   4.4) MOBILE SIDEBAR ADJUSTMENTS
   ========================================== */

@media (max-width: 996px) {
  /* Ensure row-based guide lines work on mobile */
  .theme-doc-sidebar-item-category-level-1 ul.menu__list .menu__link::before {
    background: var(--ifm-border-color);
  }

  /* Active item line on mobile */
  .theme-doc-sidebar-item-category-level-1 ul.menu__list .menu__link--active::before {
    background: var(--ifm-color-primary);
  }

  /* Touch-friendly tap targets */
  .theme-doc-sidebar-menu .menu__link {
    padding: 12px 10px;
    min-height: 44px;
  }
}

/* Navbar mobile sidebar inherits these styles */
.navbar-sidebar .menu__list-item-collapsible {
  border-radius: var(--radius-md);
}
