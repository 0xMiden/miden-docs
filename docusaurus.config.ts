import type { Config } from "@docusaurus/types";
import { themes as prismThemes } from "prism-react-renderer";
import remarkMath from "remark-math";
import rehypeKatex from "rehype-katex";

const config: Config = {
  title: "Miden Docs",
  tagline: "One stop shop for everything Miden",
  favicon: "img/favicon.ico",

  url: "https://0xmiden.github.io/",
  baseUrl: "/",

  organizationName: "0xMiden",
  projectName: "miden-docs",

  onBrokenLinks: "warn",
  onBrokenMarkdownLinks: "warn",

  i18n: {
    defaultLocale: "en",
    locales: ["en"],
  },

  presets: [
    [
      "classic",
      /** @type {import('@docusaurus/preset-classic').Options} */
      {
        docs: {
          // Single global docs root
          routeBasePath: "/", // site lives at /
          sidebarPath: "./sidebars.ts", // use autogenerated,
          includeCurrentVersion: true,
          versions: {
            current: {
              label: "Next",
            },
          },
          remarkPlugins: [remarkMath],
          rehypePlugins: [rehypeKatex],
        }, // Disable preset docs plugin => using own plugin
        blog: false, // Disable blog
        theme: {
          customCss: "./src/custom/styles.css",
        },
      },
    ],
  ],

  // enable mermaid diagrams and math support
  markdown: {
    mermaid: true,
  },

  stylesheets: [
    {
      href: "https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css",
      type: "text/css",
      integrity:
        "sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM",
      crossorigin: "anonymous",
    },
  ],

  themes: ["@docusaurus/theme-mermaid"],

  themeConfig:
    /** @type {import('@docusaurus/preset-classic').ThemeConfig} */
    {
      colorMode: {
        defaultMode: "light",
        disableSwitch: true,
      },
      // TODO: implement exact code theme styling
      prism: {
        theme: prismThemes.oneLight,
        darkTheme: prismThemes.oneDark,
        additionalLanguages: ["rust", "solidity", "toml", "yaml"],
      },
      algolia: {
        appId: "3G8FFE98IO",
        // safe to commit
        apiKey: "657bdab7adbb5747f645a0022b85ffd3",
        indexName: "intro",
        contextualSearch: true,
        // externalUrlRegex: "external\\.com|domain\\.com",
        // replaceSearchResultPathname: {
        //   from: "/docs/", // or as RegExp: /\/docs\//
        //   to: "/",
        // },
        searchParameters: {},
        searchPagePath: "search",
        insights: false,

        // askAi: "ALGOLIA_ASK_AI_ASSISTANT_ID",
      },
      navbar: {
        logo: {
          src: "img/logo.png",
          alt: "Miden Logo",
          height: 240,
        },
        title: "MIDEN",
        items: [
          {
            type: "docsVersionDropdown",
            position: "left",
            dropdownActiveClassDisabled: true,
          },
          {
            href: "https://github.com/0xMiden/",
            label: "GitHub",
            position: "right",
          },
        ],
      },
    },
};

export default config;
